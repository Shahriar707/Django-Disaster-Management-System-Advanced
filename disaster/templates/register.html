{% extends 'home.html' %}

{% block title %} Register - Disaster Management {% endblock %}

{% block content %}
    <div class="container mt-5">
        <h1 class="text-center mb-4">Register</h1>

        <div class="row justify-content-center">
            <div class="col-md-6">
                <form id="register-form" method="POST">
                    {% csrf_token %}
                    {{ form.as_p }}
                    <button type="submit" class="btn btn-primary btn-block">Register</button>
                </form>
                <div id="messages" class="mt-3"></div>
            </div>
        </div>
    </div>
    <script>
        $(document).ready(function() {
            $('#register-form').on('submit', function(event) {
                event.preventDefault();

                $.ajax({
                    url: '{% url "register" %}',
                    type: 'POST',
                    data: $(this.).serialize(),
                    success: function(response) {
                        $('#message').html('<div class="alert alert-success">Registration successful! Redirecting...</div>');
                        setTimeout(function() {
                            window.location.href = "{% url 'home' %}";
                        }, 2000);
                    },
                    error: function(response) {
                        $('#message').html('<div class="alert alert-danger">Error during registration. Please try again.</div>');
                    }
                });
            });
        });
    </script>
{% endblock %}